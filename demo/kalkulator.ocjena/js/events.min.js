$(document).ready(function(){var e={};var t={ui:function(){var n=$("div.navbar");var r=$("table.table");e={form:false,nav:{title:$(n).find("a.brand"),button:$(n).find("a.btn-navbar"),li:{score:$(n).find("a.change.score"),positive:$(n).find("a.change.positive"),print:$(n).find("a.print")}},table:{head:{grade:$(r).find("th").eq(0),percentage:$(r).find("th").eq(1),score:$(r).find("th").eq(2)},body:[]}};e.form=$("<form />").attr("action","pdf").attr("method","post").attr("target","_blank").css("display","none").appendTo("body");$("<input />").attr("type","text").attr("name","title").attr("class","lang").attr("value",lang.title).appendTo(e.form);$("<input />").attr("type","text").attr("name","grade").attr("class","lang").attr("value",lang.table.grade).appendTo(e.form);$("<input />").attr("type","text").attr("name","percentage").attr("class","lang").attr("value",lang.table.percentage).appendTo(e.form);$("<input />").attr("type","text").attr("name","score").attr("class","lang").attr("value",lang.table.score).appendTo(e.form);for(var i=1;i<=5;i++){e.table.body[i]={};e.table.body[i].parent=$(r).find("tr.grade"+i);e.table.body[i].children={percent:{from:$(e.table.body[i].parent).find("td.percent_from"),to:$(e.table.body[i].parent).find("td.percent_to")},score:{from:$(e.table.body[i].parent).find("td.score_from"),num:$(e.table.body[i].parent).find("td.score_num"),to:$(e.table.body[i].parent).find("td.score_to")}}}return t},lang:function(){$("head").find("title").html(lang.title);$(e.nav.title).html(lang.nav.title);$(e.nav.li.score).html(lang.nav.score);$(e.nav.li.positive).html(lang.nav.positive);$(e.nav.li.print).html(lang.nav.print);$(e.table.head.grade).html(lang.table.grade);$(e.table.head.percentage).html(lang.table.percentage);$(e.table.head.score).html(lang.table.score);return t},refresh:function(){n.refresh(function(t){$(e.form).find("input.value").remove();$.each(t,function(t,n){if(n!==false){$("<input />").attr("type","text").attr("name","grade"+t+"_"+"from").attr("class","value").attr("value",n.from).appendTo(e.form);$("<input />").attr("type","text").attr("name","grade"+t+"_"+"to").attr("class","value").attr("value",n.to).appendTo(e.form)}});for(var r=1;r<=5;r++){var i="-",s="-",o="-",u="-",a="-";if(t[r]!==false){o=t[r].from;u=t[r].to;a="+"+(u-o);i=(o/n.score()*100).toFixed(2);s=(u/n.score()*100).toFixed(2)}$(e.table.body[r].children.percent.from).html(i);$(e.table.body[r].children.percent.to).html(s);$(e.table.body[r].children.score.from).html(o);$(e.table.body[r].children.score.num).html(a);$(e.table.body[r].children.score.to).html(u)}});return t},nav:function(){$(e.nav.title).click(function(){$(this).blur();$(e.nav.button).click();return false});return t},dialog:function(){$("div.navbar").find("a.change").click(function(){var r=this;$(r).blur();$(e.nav.button).click();var i=lang.dialog.title;var s=lang.dialog.text.score;var o=0;var u=n.score().toFixed(o);if($(r).hasClass("positive")){s=lang.dialog.text.positive;o=2;u=n.positive().toFixed(o)}var a="";a+='<form class="bootbox-form">';a+='<label for="bootbox-form-label">'+s+"</label>";a+='<input id="bootbox-form-label" class="bootbox-input form-control" type="text" value="'+u+'" maxlength="5" autocapitalize="off" autocorrect="off" />';a+="</form>";var f=bootbox.dialog({title:i,message:a,buttons:{ok:{label:"<small>"+lang.dialog.button.ok+"</small>",className:"btn-ok btn-primary",callback:function(){var e=$(f).find(".bootbox-input").val();if(!(!isNaN(parseFloat(e))&&isFinite(e))){if($(f).find(".alert-error").length==0){var i="";i+='<div class="alert alert-error fade in">';i+='<button type="button" class="close" data-dismiss="alert">Ã—</button>';i+=lang.dialog.text.error;i+="</div>";i=$(i).css("display","none");$(f).find(".alert-error").remove();$(f).find(".bootbox-body").prepend(i);$(i).fadeIn(100)}$(f).find(".bootbox-input").select().focus();return false}if($(r).hasClass("score"))n.score(e);if($(r).hasClass("positive"))n.positive(e);t.refresh()}},cancel:{label:"<small>"+lang.dialog.button.cancel+"</small>",className:"btn-cancel btn-default"}},onEscape:function(){this.close()}});setTimeout(function(){$(f).find(".bootbox-input").select().focus().keypress(function(e){if(e.which==13){$(f).find(".btn-ok").click();return false}else{}})},500);return false});return t},print:function(){$(e.nav.li.print).click(function(){$(e.nav.button).click();$(e.form).submit();return false});return t}};var n=new Calculator;n.refresh();t.ui().lang().nav().dialog().print().refresh()})
